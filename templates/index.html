{% extends "layout.html" %}

{% block title %}
    Home
{% endblock %}

{% block main %}

    <div class="next_race">

        <div class="card text-center text-muted bg-light">
            <div class="card-header">
                <h4 class="page_header"> Race Schedule </h4>
                <br>
                <ul class="nav nav-tabs card-header-tabs nav-justified" data-bs-tabs="tabs">
                    {% if last_race %}
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#last_race"> ROUND {{ last_race.round }} - Previous race: {{ last_race.race.0.raceName }} </a>
                        </li>
                    {% endif %}
                    {% if next %}
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="true" data-bs-toggle="tab" href="#next"> ROUND {{ next.round }} - Next race: {{ next.race.0.raceName }} </a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="true" data-bs-toggle="tab" href="#next"> SEASON ENDED </a>
                        </li>
                    {% endif %}
                    {% if next_plus_one %}
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#next_plus_one"> ROUND {{ next_plus_one.round }} - {{ next_plus_one.race.0.raceName }} </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
            <form class="card-body tab-content">
                {% if last_race %}   
                    <div class="tab-pane" id="last_race">
                        <div class="card-body">
                            <h5> {{ last_race.race.raceName }} </h5>
                            <p class="card-text"> {{ last_race.race.0.circuit.circuitName }} </p>
                            <p class="card-text"> {{ last_race.race.0.circuit.country }} </p>
                            <p class="card-text"> {{ last_race.race.0.schedule.race.date }} </p>
                            <p class="card-text"> {{ last_race.race.0.schedule.race.time }} </p>
                            <img class="index_logo" src="/static/track_pics/{{last_race.race.0.circuit.circuitName}}.jpg" alt="image"><br><br>
                            <a href="{{last_race.race.0.circuit.url}}" class="btn btn-primary" target="_blank" rel="noopener noreferrer"> More circuit info from Wikipedia </a>
                        </div>
                        <div class="card-footer text-muted">
                            {{ last_race.race.0.circuit.city }}
                            <div>
                                <iframe id="myMap" width="250" height="200" frameborder="0" src="https://www.bing.com/maps/embed?h=200&w=250&cp={{ last_race }}~{{ last_race }}&lvl=5&typ=d&sty=r&src=SHELL&FORM=MBEDV8" scrolling="no">
                                </iframe>
                            </div>
                        </div>
                        <div>
                            <a id="largeMapLink" target="_blank" href="https://www.bing.com/maps?cp={{ last_race }}~{{ last_race }}&amp;sty=r&amp;lvl=5&amp;FORM=MBEDLD">View Larger Map</a> &nbsp; | &nbsp;
                        </div>
                    </div>
                {% endif %}

                {% if next %}
                    <div class="tab-pane active" id="next">
                        <div class="card-body">
                            <h5> {{ next.raceName }} </h5>
                            <p class="card-text"> {{ next.race.0.circuit.circuitName }} </p>
                            <p class="card-text"> {{ next.race.0.circuit.country }} </p>
                            <p class="card-text"> {{ next.race.0.schedule.race.date }} </p>
                            <p class="card-text"> {{ next.race.0.schedule.race.time }} </p>
                            <img class="index_logo" src="/static/track_pics/{{next.race.0.circuit.circuitName}}.jpg" alt="image"><br><br>
                            <a href="{{next.race.0.circuit.url}}" class="btn btn-primary" target="_blank" rel="noopener noreferrer"> More circuit info from Wikipedia </a>
                        </div>
                        <div class="card-footer text-muted">
                            {{ next.race.0.circuit.city }}
                            <div>
                                <iframe id="myMap" width="250" height="200" frameborder="0" src="https://www.bing.com/maps/embed?h=200&w=250&cp={{ next }}~{{ next }}&lvl=5&typ=d&sty=r &src=SHELL&FORM=MBEDV8" scrolling="no">
                                </iframe>
                            </div>
                        </div>
                        <div>
                            <a id="largeMapLink" target="_blank" href="https://www.bing.com/maps?cp={{ next }}~{{ next }}&amp;sty=r&amp;lvl=5&amp;FORM=MBEDLD">View Larger Map</a> &nbsp; | &nbsp;
                        </div>
                    </div>
                {% else %}
                    <div class="tab-pane active" id="next">
                        <div class="card-body">
                            <h5> SEASON ENDED </h5>
                        </div>
                {% endif %}
                {% if next_plus_one %}
                    <div class="tab-pane" id="next_plus_one">
                        <div class="card-body">
                            <h5> {{ next_plus_one.raceName }} </h5>
                            <p class="card-text"> {{ next_plus_one.race.0.circuit.circuitName }} </p>
                            <p class="card-text"> {{ next_plus_one.race.0.circuit.country }} </p>
                            <p class="card-text"> {{ next_plus_one.race.0.schedule.race.date }} </p>
                            <p class="card-text"> {{ next_plus_one.race.0.schedule.race.time }} </p>
                            <img class="index_logo" src="/static/track_pics/{{next_plus_one.race.0.circuit.circuitName}}.jpg" alt="image"><br><br>
                            <a href="{{next_plus_one.race.0.circuit.url}}" class="btn btn-primary" target="_blank" rel="noopener noreferrer"> More circuit info from Wikipedia </a>
                        </div>
                        <div class="card-footer text-muted">
                            {{ next_plus_one.race.0.circuit.city }}
                            <div>
                                <iframe id="myMap" width="250" height="200" frameborder="0" src="https://www.bing.com/maps/embed?h=200&w=250&cp={{ next_plus_one }}~{{ next_plus_one }}&lvl=5&typ=d&sty=r&src=SHELL&FORM=MBEDV8" scrolling="no">
                                </iframe>
                            </div>
                        </div>
                        <div>
                            <a id="largeMapLink" target="_blank" href="https://www.bing.com/maps?cp={{ next_plus_one }}~{{ next_plus_one }}&amp;sty=r&amp;lvl=5&amp;FORM=MBEDLD">View Larger Map</a> &nbsp; | &nbsp;
                        </div>
                    </div>
                {% endif %}
            </form>
        </div>
    </div>

{% endblock %}